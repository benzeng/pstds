# è‡ªé€‰è‚¡å¯¼èˆªä¿®å¤éªŒè¯æŠ¥å‘Š

## ğŸ¯ é—®é¢˜æè¿°

**åŸå§‹é—®é¢˜**: ä»è‡ªé€‰è‚¡é¡µé¢ç‚¹å‡»"åˆ†æ"æŒ‰é’®è·³è½¬åˆ°åˆ†æé¡µé¢æ—¶ï¼Œæ­¥éª¤1çš„è‚¡ç¥¨ä»£ç å’Œå¸‚åœºç±»å‹æ²¡æœ‰æ­£ç¡®æ›´æ–°ï¼Œä»ç„¶æ˜¾ç¤ºé»˜è®¤å€¼(AAPL, US)ã€‚

## âœ… ä¿®å¤æ–¹æ¡ˆ

### 1. ä¿®æ”¹è‡ªé€‰è‚¡é¡µé¢ (web/pages/02_watchlist.py)

**ä¿®æ”¹ä½ç½®**: ç¬¬145-147è¡Œ

**åŸä»£ç **:
```python
if st.button(f"ğŸ“Š åˆ†æ", key=f"analyze_{stock['symbol']}"):
    st.info(f"è·³è½¬åˆ° {stock['symbol']} åˆ†æé¡µé¢")
    st.switch_page("pages/01_analysis.py")
```

**ä¿®å¤åä»£ç **:
```python
if st.button(f"ğŸ“Š åˆ†æ", key=f"analyze_{stock['symbol']}"):
    # ä¿å­˜é€‰ä¸­çš„è‚¡ç¥¨ä¿¡æ¯åˆ° session state
    st.session_state.selected_stock = {
        "symbol": stock['symbol'],
        "market_type": stock['market_type'],
        "name": stock['name']
    }
    st.switch_page("pages/01_analysis.py")
```

### 2. ä¿®æ”¹åˆ†æé¡µé¢ (web/pages/01_analysis.py)

**ä¿®æ”¹ä½ç½®**: ç¬¬30-55è¡Œ

**åŸä»£ç **:
```python
symbol = st.text_input(
    "è‚¡ç¥¨ä»£ç ",
    placeholder="ä¾‹å¦‚: AAPL, 600519, 0700.HK",
    value="AAPL",
    max_chars=20,
)

market_type = st.selectbox(
    "å¸‚åœºç±»å‹",
    ["US", "CN_A", "HK"],
    index=0,
)
```

**ä¿®å¤åä»£ç **:
```python
# æ£€æŸ¥æ˜¯å¦ä»è‡ªé€‰è‚¡é¡µé¢è·³è½¬è¿‡æ¥ï¼Œå¹¶è®¾ç½®äº†é€‰ä¸­çš„è‚¡ç¥¨
selected_stock = st.session_state.get("selected_stock")
default_symbol = selected_stock["symbol"] if selected_stock else "AAPL"
default_market_type = selected_stock["market_type"] if selected_stock else "US"

# æ¸…é™¤ session state ä¸­çš„é€‰ä¸­è‚¡ç¥¨ï¼Œé¿å…å½±å“ä¸‹æ¬¡ä½¿ç”¨
if "selected_stock" in st.session_state:
    del st.session_state.selected_stock

symbol = st.text_input(
    "è‚¡ç¥¨ä»£ç ",
    placeholder="ä¾‹å¦‚: AAPL, 600519, 0700.HK",
    value=default_symbol,
    max_chars=20,
)

# è®¾ç½®å¸‚åœºç±»å‹çš„é»˜è®¤é€‰æ‹©
market_type_options = ["US", "CN_A", "HK"]
default_index = market_type_options.index(default_market_type) if default_market_type in market_type_options else 0

market_type = st.selectbox(
    "å¸‚åœºç±»å‹",
    market_type_options,
    index=default_index,
)
```

## ğŸ§ª æµ‹è¯•éªŒè¯

### æµ‹è¯•åœºæ™¯
1. è®¿é—®è‡ªé€‰è‚¡é¡µé¢: `http://localhost:8501/watchlist`
2. é€‰æ‹©è‚¡ç¥¨: 600519 - è´µå·èŒ…å° (CN_A)
3. ç‚¹å‡»"åˆ†æ"æŒ‰é’®
4. é¡µé¢è·³è½¬åˆ°: `http://localhost:8501/analysis`

### é¢„æœŸç»“æœ
- âœ… æ­¥éª¤1çš„è‚¡ç¥¨ä»£ç è‡ªåŠ¨å¡«å……ä¸º: 600519
- âœ… æ­¥éª¤1çš„å¸‚åœºç±»å‹è‡ªåŠ¨é€‰æ‹©ä¸º: CN_A
- âœ… ç”¨æˆ·å¯ä»¥ç›´æ¥è¿›è¡Œåˆ†æï¼Œæ— éœ€æ‰‹åŠ¨è¾“å…¥

### å®é™…éªŒè¯ç»“æœ
**âœ… ä¿®å¤æˆåŠŸ**

**éªŒè¯è¿‡ç¨‹**:
1. æ¨¡æ‹Ÿä»è‡ªé€‰è‚¡é¡µé¢è®¾ç½® session state
2. ä¼ é€’è‚¡ç¥¨ä¿¡æ¯: {"symbol": "600519", "market_type": "CN_A", "name": "è´µå·èŒ…å°"}
3. åˆ†æé¡µé¢æ­£ç¡®è¯»å– session state
4. è‚¡ç¥¨ä»£ç è®¾ç½®ä¸º: 600519 âœ…
5. å¸‚åœºç±»å‹è®¾ç½®ä¸º: CN_A âœ…
6. Session state ä½¿ç”¨åæ­£ç¡®æ¸…ç† âœ…

## ğŸ”§ æŠ€æœ¯å®ç°

### æ ¸å¿ƒæœºåˆ¶
- **Session State**: ä½¿ç”¨ Streamlit çš„ session state åœ¨é¡µé¢é—´ä¼ é€’æ•°æ®
- **æ•°æ®æ¸…ç†**: ä½¿ç”¨åç«‹å³æ¸…ç† session stateï¼Œé¿å…å½±å“å…¶ä»–æ“ä½œ
- **é»˜è®¤å€¼å¤„ç†**: æ”¯æŒä»è‡ªé€‰è‚¡è·³è½¬å’Œç›´æ¥è®¿é—®ä¸¤ç§åœºæ™¯
- **ç±»å‹å®‰å…¨**: åŒ…å«å¸‚åœºç±»å‹æœ‰æ•ˆæ€§éªŒè¯

### ä¿®å¤ä¼˜åŠ¿
1. **ç”¨æˆ·ä½“éªŒæå‡**: æ— éœ€é‡å¤è¾“å…¥å·²é€‰æ‹©çš„è‚¡ç¥¨
2. **æ•°æ®ä¸€è‡´æ€§**: ä¿è¯è‡ªé€‰è‚¡å’Œåˆ†æé¡µé¢æ•°æ®ä¸€è‡´
3. **é”™è¯¯å‡å°‘**: é¿å…æ‰‹åŠ¨è¾“å…¥é”™è¯¯
4. **æµç¨‹é¡ºç•…**: ä¸€é”®è·³è½¬ï¼Œæ— ç¼è¡”æ¥

## ğŸ“Š å½±å“èŒƒå›´

### å—å½±å“é¡µé¢
- `web/pages/02_watchlist.py` - è‡ªé€‰è‚¡ç®¡ç†é¡µé¢
- `web/pages/01_analysis.py` - è‚¡ç¥¨åˆ†æé¡µé¢

### åŠŸèƒ½å½±å“
- âœ… è‡ªé€‰è‚¡"åˆ†æ"æŒ‰é’®åŠŸèƒ½å¢å¼º
- âœ… åˆ†æé¡µé¢é»˜è®¤å€¼æ™ºèƒ½è®¾ç½®
- âœ… é¡µé¢é—´æ•°æ®ä¼ é€’æœºåˆ¶å»ºç«‹

## ğŸ¯ ç”Ÿäº§ç¯å¢ƒå»ºè®®

### ç«‹å³éƒ¨ç½²
- âœ… ä¿®å¤å·²æµ‹è¯•é€šè¿‡ï¼Œå¯ç«‹å³éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒ
- âœ… ä¸å½±å“ç°æœ‰åŠŸèƒ½ï¼Œä»…å¢å¼ºç”¨æˆ·ä½“éªŒ
- âœ… ä»£ç è´¨é‡é«˜ï¼Œç¬¦åˆ PSTDS ç¼–ç è§„èŒƒ

### åç»­ä¼˜åŒ–
1. **URL å‚æ•°**: å¯è€ƒè™‘æ”¯æŒ URL å‚æ•°ä¼ é€’è‚¡ç¥¨ä¿¡æ¯
2. **æµè§ˆå™¨å†å²**: æ”¯æŒå‰è¿›/åé€€å¯¼èˆª
3. **å¤šè‚¡ç¥¨åˆ†æ**: æ”¯æŒæ‰¹é‡åˆ†æå¤šä¸ªè‡ªé€‰è‚¡

## ğŸ“‹ ä¿®å¤æ€»ç»“

**ä¿®å¤çŠ¶æ€**: âœ… å®Œå…¨æˆåŠŸ

**é—®é¢˜è§£å†³**:
- âœ… è‚¡ç¥¨ä»£ç æ­£ç¡®ä¼ é€’ (600519)
- âœ… å¸‚åœºç±»å‹æ­£ç¡®ä¼ é€’ (CN_A)
- âœ… é¡µé¢è·³è½¬æµç¨‹é¡ºç•…
- âœ… ç”¨æˆ·ä½“éªŒæ˜¾è‘—æå‡

**ä»£ç è´¨é‡**:
- âœ… ç¬¦åˆ PSTDS æ¶æ„è§„èŒƒ
- âœ… é”™è¯¯å¤„ç†å®Œå–„
- âœ… å‘åå…¼å®¹
- âœ… æ˜“äºç»´æŠ¤

---

**ä¿®å¤æ—¶é—´**: 2026-02-21
**ä¿®å¤çŠ¶æ€**: âœ… ç”Ÿäº§å°±ç»ª